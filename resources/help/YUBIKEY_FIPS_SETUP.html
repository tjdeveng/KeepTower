<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="pandoc">
    <title>YubiKey FIPS-140-3 Configuration
Guide - KeepTower Help</title>
    <style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}
.display.math{display: block; text-align: center; margin: 0.5rem auto;}

pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
    <style type="text/css">
:root {
--bg-color: #ffffff;
--text-color: #2e3436;
--link-color: #3584e4;
--link-hover: #1c71d8;
--code-bg: #f6f5f4;
--border-color: #deddda;
--header-bg: #f6f5f4;
--sidebar-bg: #fafafa;
}
@media (prefers-color-scheme: dark) {
:root {
--bg-color: #1e1e1e;
--text-color: #eeeeec;
--link-color: #62a0ea;
--link-hover: #99c1f1;
--code-bg: #2e2e2e;
--border-color: #3e3e3e;
--header-bg: #2a2a2a;
--sidebar-bg: #242424;
}
}
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}
body {
font-family: 'Cantarell', 'DejaVu Sans', sans-serif;
line-height: 1.6;
color: var(--text-color);
background-color: var(--bg-color);


}
.container {
max-width: 900px;
margin: 0 auto;
padding: 20px;
}

h1, h2, h3, h4, h5, h6 {
margin-top: 24px;
margin-bottom: 16px;
font-weight: 600;
line-height: 1.25;
}
h1 {
font-size: 2em;
border-bottom: 2px solid var(--border-color);
padding-bottom: 8px;
}
h2 {
font-size: 1.5em;
border-bottom: 1px solid var(--border-color);
padding-bottom: 6px;
}
h3 {
font-size: 1.25em;
}
h4 {
font-size: 1.1em;
}
p {
margin-bottom: 16px;
}

a {
color: var(--link-color);
text-decoration: none;
}
a:hover {
color: var(--link-hover);
text-decoration: underline;
}

ul, ol {
margin-bottom: 16px;
padding-left: 32px;
}
li {
margin-bottom: 8px;
}

code {
background-color: var(--code-bg);
padding: 2px 6px;
border-radius: 3px;
font-family: 'Source Code Pro', 'Courier New', monospace;
font-size: 0.9em;
}
pre {
background-color: var(--code-bg);
border: 1px solid var(--border-color);
border-radius: 6px;
padding: 16px;
overflow-x: auto;
margin-bottom: 16px;
}
pre code {
background-color: transparent;
padding: 0;
}

table {
width: 100%;
border-collapse: collapse;
margin-bottom: 16px;
}
th, td {
padding: 12px;
text-align: left;
border: 1px solid var(--border-color);
}
th {
background-color: var(--header-bg);
font-weight: 600;
}

blockquote {
border-left: 4px solid var(--link-color);
padding-left: 16px;
margin: 16px 0;
font-style: italic;
color: var(--text-color);
opacity: 0.9;
}

.nav-header {
background-color: var(--header-bg);
padding: 16px 20px;
border-bottom: 1px solid var(--border-color);
margin-bottom: 20px;
}
.nav-header h1 {
margin: 0;
border: none;
padding: 0;
font-size: 1.5em;
}
.nav-links {
margin-top: 12px;
display: flex;
gap: 16px;
flex-wrap: wrap;
}
.nav-links a {
padding: 6px 12px;
background-color: var(--code-bg);
border-radius: 4px;
font-size: 0.9em;
}

.note, .warning, .tip {
padding: 16px;
border-left: 4px solid;
margin: 16px 0;
border-radius: 4px;
}
.note {
background-color: rgba(53, 132, 228, 0.1);
border-color: #3584e4;
}
.warning {
background-color: rgba(230, 97, 0, 0.1);
border-color: #e66100;
}
.tip {
background-color: rgba(38, 162, 105, 0.1);
border-color: #26a269;
}

img {
max-width: 100%;
height: auto;
margin: 16px 0;
border-radius: 6px;
}

hr {
border: none;
border-top: 1px solid var(--border-color);
margin: 24px 0;
}

.footer {
margin-top: 48px;
padding-top: 24px;
border-top: 1px solid var(--border-color);
font-size: 0.9em;
opacity: 0.8;
text-align: center;
}

kbd {
background-color: var(--code-bg);
border: 1px solid var(--border-color);
border-radius: 3px;
padding: 2px 6px;
font-family: 'Cantarell', sans-serif;
font-size: 0.85em;
box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2);
}

.toc {
background-color: var(--sidebar-bg);
border: 1px solid var(--border-color);
border-radius: 6px;
padding: 16px;
margin-bottom: 24px;
}
.toc h2 {
margin-top: 0;
font-size: 1.2em;
border: none;
padding: 0;
}
.toc ul {
margin-bottom: 0;
}
.toc li {
margin-bottom: 4px;
}
</style>
</head>
<body>
<div class="nav-header">
    <h1>YubiKey FIPS-140-3 Configuration Guide</h1>
    <div class="nav-links">
        <a href="00-home.html">üè† Home</a>
        <a href="01-getting-started.html">üöÄ Getting Started</a>
        <a href="02-installation.html">üíæ Installation</a>
        <a href="03-user-guide.html">üìñ User Guide</a>
        <a href="04-faq.html">‚ùì FAQ</a>
        <a href="05-security.html">üîí Security</a>
    </div>
</div>
<div class="container">
<nav id="TOC" role="doc-toc">
<div class="toc">
<h2>Table of Contents</h2>
<ul>
<li><a href="#yubikey-fips-140-3-configuration-guide" id="toc-yubikey-fips-140-3-configuration-guide">YubiKey FIPS-140-3
Configuration Guide</a>
<ul>
<li><a href="#overview" id="toc-overview">Overview</a>
<ul>
<li><a href="#what-youll-learn" id="toc-what-youll-learn">What You‚Äôll
Learn</a></li>
</ul></li>
<li><a href="#prerequisites" id="toc-prerequisites">Prerequisites</a>
<ul>
<li><a href="#hardware-requirements" id="toc-hardware-requirements">Hardware Requirements</a></li>
<li><a href="#software-requirements" id="toc-software-requirements">Software Requirements</a></li>
</ul></li>
<li><a href="#step-1-check-yubikey-compatibility" id="toc-step-1-check-yubikey-compatibility">Step 1: Check YubiKey
Compatibility</a>
<ul>
<li><a href="#using-ykman-recommended" id="toc-using-ykman-recommended">Using ykman (Recommended)</a></li>
<li><a href="#using-ykinfo-alternative" id="toc-using-ykinfo-alternative">Using ykinfo (Alternative)</a></li>
<li><a href="#verify-hmac-sha256-support" id="toc-verify-hmac-sha256-support">Verify HMAC-SHA256 Support</a></li>
</ul></li>
<li><a href="#step-2-configure-yubikey-for-fips-mode" id="toc-step-2-configure-yubikey-for-fips-mode">Step 2: Configure
YubiKey for FIPS Mode</a>
<ul>
<li><a href="#option-a-using-ykman-recommended" id="toc-option-a-using-ykman-recommended">Option A: Using ykman
(Recommended)</a></li>
<li><a href="#option-b-using-ykpersonalize-alternative" id="toc-option-b-using-ykpersonalize-alternative">Option B: Using
ykpersonalize (Alternative)</a></li>
</ul></li>
<li><a href="#step-3-verify-configuration" id="toc-step-3-verify-configuration">Step 3: Verify Configuration</a>
<ul>
<li><a href="#quick-verification" id="toc-quick-verification">Quick
Verification</a></li>
<li><a href="#detailed-verification" id="toc-detailed-verification">Detailed Verification</a></li>
<li><a href="#test-challenge-response" id="toc-test-challenge-response">Test Challenge-Response</a></li>
</ul></li>
<li><a href="#step-4-configure-keeptower" id="toc-step-4-configure-keeptower">Step 4: Configure KeepTower</a>
<ul>
<li><a href="#creating-a-new-fips-compliant-vault" id="toc-creating-a-new-fips-compliant-vault">Creating a New
FIPS-Compliant Vault</a></li>
<li><a href="#verifying-fips-mode-in-keeptower" id="toc-verifying-fips-mode-in-keeptower">Verifying FIPS Mode in
KeepTower</a></li>
</ul></li>
<li><a href="#fips-140-3-compliance-details" id="toc-fips-140-3-compliance-details">FIPS-140-3 Compliance Details</a>
<ul>
<li><a href="#what-makes-this-fips-compliant" id="toc-what-makes-this-fips-compliant">What Makes This
FIPS-Compliant?</a></li>
<li><a href="#yubikey-fips-edition-optional" id="toc-yubikey-fips-edition-optional">YubiKey FIPS Edition
(Optional)</a></li>
</ul></li>
<li><a href="#troubleshooting" id="toc-troubleshooting">Troubleshooting</a>
<ul>
<li><a href="#issue-yubikey-not-detected" id="toc-issue-yubikey-not-detected">Issue: ‚ÄúYubiKey not
detected‚Äù</a></li>
<li><a href="#issue-slot-2-not-configured" id="toc-issue-slot-2-not-configured">Issue: ‚ÄúSlot 2 not
configured‚Äù</a></li>
<li><a href="#issue-hmac-sha256-not-available" id="toc-issue-hmac-sha256-not-available">Issue: ‚ÄúHMAC-SHA256 not
available‚Äù</a></li>
<li><a href="#issue-touch-not-working" id="toc-issue-touch-not-working">Issue: ‚ÄúTouch not working‚Äù</a></li>
<li><a href="#issue-wrong-response-size" id="toc-issue-wrong-response-size">Issue: ‚ÄúWrong response size‚Äù</a></li>
</ul></li>
<li><a href="#security-best-practices" id="toc-security-best-practices">Security Best Practices</a>
<ul>
<li><a href="#use-touch-requirement" id="toc-use-touch-requirement">1.
Use Touch Requirement ‚úÖ</a></li>
<li><a href="#backup-your-configuration" id="toc-backup-your-configuration">2. Backup Your Configuration
üíæ</a></li>
<li><a href="#physical-security" id="toc-physical-security">3. Physical
Security üîí</a></li>
<li><a href="#firmware-updates" id="toc-firmware-updates">4. Firmware
Updates</a></li>
</ul></li>
<li><a href="#migration-from-sha-1-legacy-vaults" id="toc-migration-from-sha-1-legacy-vaults">Migration from SHA-1 (Legacy
Vaults)</a>
<ul>
<li><a href="#approach-1-create-new-fips-compliant-vault" id="toc-approach-1-create-new-fips-compliant-vault">Approach 1: Create
New FIPS-Compliant Vault</a></li>
<li><a href="#approach-2-continue-using-sha-1-not-recommended" id="toc-approach-2-continue-using-sha-1-not-recommended">Approach 2:
Continue Using SHA-1 (Not Recommended)</a></li>
</ul></li>
<li><a href="#reference-command-quick-reference" id="toc-reference-command-quick-reference">Reference: Command Quick
Reference</a></li>
<li><a href="#additional-resources" id="toc-additional-resources">Additional Resources</a></li>
<li><a href="#getting-help" id="toc-getting-help">Getting Help</a></li>
</ul></li>
</ul>
</div>
</nav>
<h1 id="yubikey-fips-140-3-configuration-guide">YubiKey FIPS-140-3
Configuration Guide</h1>
<p><strong>Version:</strong> 1.0 <strong>Date:</strong> 2026-01-01
<strong>Applies to:</strong> KeepTower v0.3.0-beta and later</p>
<hr />
<h2 id="overview">Overview</h2>
<p>This guide explains how to configure your YubiKey for FIPS-140-3
compliant use with KeepTower. Following these steps ensures your vault
encryption uses only FIPS-approved cryptographic algorithms.</p>
<h3 id="what-youll-learn">What You‚Äôll Learn</h3>
<ul>
<li>‚úÖ Check if your YubiKey supports FIPS-compliant algorithms</li>
<li>‚úÖ Configure YubiKey Challenge-Response with HMAC-SHA256</li>
<li>‚úÖ Verify your configuration is FIPS-compliant</li>
<li>‚úÖ Troubleshoot common configuration issues</li>
</ul>
<hr />
<h2 id="prerequisites">Prerequisites</h2>
<h3 id="hardware-requirements">Hardware Requirements</h3>
<ul>
<li><strong>YubiKey 5 Series</strong> (firmware 5.0 or later)
<ul>
<li>YubiKey 5 NFC</li>
<li>YubiKey 5 Nano</li>
<li>YubiKey 5C</li>
<li>YubiKey 5C Nano</li>
<li>YubiKey 5 FIPS ‚≠ê (recommended for FIPS-140-3 certified
hardware)</li>
</ul></li>
</ul>
<p><strong>Note:</strong> YubiKey 4 and earlier do NOT support
HMAC-SHA256 and cannot be used in FIPS mode.</p>
<h3 id="software-requirements">Software Requirements</h3>
<ul>
<li><code>yubikey-manager</code> or <code>ykman</code>
(recommended)</li>
<li>OR <code>yubikey-personalization</code> tools
(<code>ykpersonalize</code>, <code>ykinfo</code>)</li>
<li>Linux users: Install via your package manager</li>
<li>Windows users: Download from <a href="https://www.yubico.com/support/download/">Yubico website</a></li>
<li>macOS users: Install via Homebrew
(<code>brew install ykman</code>)</li>
</ul>
<hr />
<h2 id="step-1-check-yubikey-compatibility">Step 1: Check YubiKey
Compatibility</h2>
<h3 id="using-ykman-recommended">Using ykman (Recommended)</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check YubiKey info</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ykman</span> info</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected output should show:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Device type: YubiKey 5 ...</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Firmware version: 5.x.x (must be 5.0 or higher)</span></span></code></pre></div>
<h3 id="using-ykinfo-alternative">Using ykinfo (Alternative)</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check firmware version</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ykinfo</span> <span class="at">-v</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected output: version: 5.x.x</span></span></code></pre></div>
<h3 id="verify-hmac-sha256-support">Verify HMAC-SHA256 Support</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List available algorithms (ykman)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ykman</span> otp info</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Should show: Challenge-response with both SHA-1 and SHA-256 available</span></span></code></pre></div>
<p><strong>‚úÖ Compatibility Check:</strong> - Firmware 5.0-5.3: ‚úÖ
HMAC-SHA256 supported - Firmware 5.4+: ‚úÖ HMAC-SHA256 supported + FIPS
Edition available - Firmware 4.x or earlier: ‚ùå Not compatible (SHA-1
only)</p>
<hr />
<h2 id="step-2-configure-yubikey-for-fips-mode">Step 2: Configure
YubiKey for FIPS Mode</h2>
<h3 id="option-a-using-ykman-recommended">Option A: Using ykman
(Recommended)</h3>
<p><strong>Configure Slot 2 with HMAC-SHA256:</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Program slot 2 with HMAC-SHA256 challenge-response</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ykman</span> otp chalresp <span class="at">--touch</span> <span class="at">--generate</span> 2</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Flags explanation:</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># --touch: Require touch for each operation (security best practice)</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># --generate: Generate a random secret (recommended)</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2: Use slot 2 (slot 1 often reserved for OTP)</span></span></code></pre></div>
<p><strong>Alternative: Use a specific secret (advanced
users):</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use your own 20-byte hex secret</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ykman</span> otp chalresp <span class="at">--touch</span> 2 <span class="op">&lt;</span>YOUR_SECRET_HEX<span class="op">&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">WARNING</span><span class="co">: Store this secret securely - you&#39;ll need it for backup</span></span></code></pre></div>
<h3 id="option-b-using-ykpersonalize-alternative">Option B: Using
ykpersonalize (Alternative)</h3>
<p><strong>Configure Slot 2 with HMAC-SHA256:</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random secret and program slot 2</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ykpersonalize</span> <span class="at">-2</span> <span class="at">-ochal-resp</span> <span class="at">-ochal-hmac</span> <span class="at">-ohmac-sha256</span> <span class="at">-oserial-api-visible</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Flags explanation:</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># -2: Program slot 2</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># -ochal-resp: Enable challenge-response mode</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># -ochal-hmac: Use HMAC algorithm</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># -ohmac-sha256: Use SHA-256 (FIPS-approved)</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># -oserial-api-visible: Allow serial number reading</span></span></code></pre></div>
<p><strong>Important Notes:</strong> - ‚ö†Ô∏è This will
<strong>overwrite</strong> any existing configuration in slot 2 - ‚úÖ
Slot 2 is recommended (slot 1 typically used for OTP) - üîí The secret is
generated randomly and stored on the YubiKey - üíæ Consider backing up
the secret for disaster recovery</p>
<hr />
<h2 id="step-3-verify-configuration">Step 3: Verify Configuration</h2>
<h3 id="quick-verification">Quick Verification</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check slot 2 configuration</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ykman</span> otp info</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected output:</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Slot 2: programmed</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   - Challenge-response (HMAC-SHA256)</span></span></code></pre></div>
<h3 id="detailed-verification">Detailed Verification</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all YubiKey information</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ykinfo</span> <span class="at">-a</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Should show:</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># serial: &lt;your serial number&gt;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># version: 5.x.x</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># touch_level: &lt;configured touch policy&gt;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># slot2: CHAL_RESP HMAC_SHA256</span></span></code></pre></div>
<h3 id="test-challenge-response">Test Challenge-Response</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test with a sample challenge (ykman)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;test_challenge_12345678901234567890123456789012&quot;</span> <span class="kw">|</span> <span class="ex">ykman</span> otp calculate 2 <span class="at">-H</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Should return: 64-character hex string (32-byte HMAC-SHA256 response)</span></span></code></pre></div>
<hr />
<h2 id="step-4-configure-keeptower">Step 4: Configure KeepTower</h2>
<h3 id="creating-a-new-fips-compliant-vault">Creating a New
FIPS-Compliant Vault</h3>
<ol type="1">
<li><strong>Launch KeepTower</strong></li>
<li><strong>Create New Vault</strong> ‚Üí Choose location</li>
<li><strong>Enable 2FA:</strong> Check ‚ÄúUse YubiKey for 2-factor
authentication‚Äù</li>
<li><strong>Select Algorithm:</strong> Ensure ‚ÄúHMAC-SHA256‚Äù is selected
(default)</li>
<li><strong>Touch YubiKey</strong> when prompted</li>
<li><strong>Set Master Password</strong> and complete setup</li>
</ol>
<h3 id="verifying-fips-mode-in-keeptower">Verifying FIPS Mode in
KeepTower</h3>
<p>Check the vault properties: - Algorithm: <code>HMAC-SHA256</code> ‚úÖ
(FIPS-approved) - NOT: <code>HMAC-SHA1</code> ‚ùå (deprecated, not
FIPS-approved)</p>
<hr />
<h2 id="fips-140-3-compliance-details">FIPS-140-3 Compliance
Details</h2>
<h3 id="what-makes-this-fips-compliant">What Makes This
FIPS-Compliant?</h3>
<ol type="1">
<li><strong>Algorithm:</strong> HMAC-SHA256 is FIPS-approved (FIPS
180-4, FIPS 198-1)</li>
<li><strong>Key Size:</strong> 256-bit keys meet FIPS minimum
requirements</li>
<li><strong>Implementation:</strong> OpenSSL 3.5+ FIPS module for all
cryptographic operations</li>
<li><strong>Zeroization:</strong> Secure memory cleanup per FIPS-140-3
Section 7.9</li>
</ol>
<h3 id="yubikey-fips-edition-optional">YubiKey FIPS Edition
(Optional)</h3>
<p>For the highest assurance: - <strong>YubiKey 5 FIPS</strong>
(firmware 5.4.3+) - FIPS 140-2 Level 2 certified hardware - Can be
locked into FIPS mode (disables non-FIPS algorithms) - Available from
Yubico‚Äôs enterprise store</p>
<hr />
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="issue-yubikey-not-detected">Issue: ‚ÄúYubiKey not detected‚Äù</h3>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if YubiKey is connected</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">lsusb</span> <span class="kw">|</span> <span class="fu">grep</span> Yubico</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check permissions (Linux)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> usermod <span class="at">-aG</span> plugdev <span class="va">$USER</span>  <span class="co"># Log out and back in</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Test basic connectivity</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="ex">ykinfo</span> <span class="at">-v</span></span></code></pre></div>
<h3 id="issue-slot-2-not-configured">Issue: ‚ÄúSlot 2 not configured‚Äù</h3>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check current configuration</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ykman</span> otp info</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># If slot 2 shows &quot;not configured&quot;, follow Step 2 above</span></span></code></pre></div>
<h3 id="issue-hmac-sha256-not-available">Issue: ‚ÄúHMAC-SHA256 not
available‚Äù</h3>
<p><strong>Cause:</strong> Your YubiKey firmware is too old (&lt;
5.0)</p>
<p><strong>Solution:</strong> - Firmware cannot be upgraded on YubiKey -
You need to purchase a YubiKey 5 Series device - YubiKey 4 and earlier
only support SHA-1 (not FIPS-compliant)</p>
<h3 id="issue-touch-not-working">Issue: ‚ÄúTouch not working‚Äù</h3>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reconfigure with touch enabled</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ykman</span> otp chalresp <span class="at">--touch</span> <span class="at">--generate</span> 2</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test touch requirement</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;test&quot;</span> <span class="kw">|</span> <span class="ex">ykman</span> otp calculate 2 <span class="at">-H</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># You should see: &quot;Touch your YubiKey...&quot;</span></span></code></pre></div>
<h3 id="issue-wrong-response-size">Issue: ‚ÄúWrong response size‚Äù</h3>
<p><strong>Cause:</strong> Slot is configured with SHA-1 instead of
SHA-256</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check algorithm</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ykman</span> otp info</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># If showing SHA-1, reconfigure with SHA-256</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="ex">ykman</span> otp chalresp <span class="at">--touch</span> <span class="at">--generate</span> 2</span></code></pre></div>
<hr />
<h2 id="security-best-practices">Security Best Practices</h2>
<h3 id="use-touch-requirement">1. Use Touch Requirement ‚úÖ</h3>
<p>Always enable touch requirement (<code>--touch</code> flag): -
Prevents malware from silently using YubiKey - Provides physical
confirmation of each operation - Recommended by NIST and security
experts</p>
<h3 id="backup-your-configuration">2. Backup Your Configuration üíæ</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export slot 2 secret (if you used ykpersonalize)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># STORE THIS SECURELY - it&#39;s your backup key</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ykpersonalize</span> <span class="at">-2</span> <span class="at">-ooath-hotp</span> <span class="at">-oappend-cr</span> <span class="at">-ofixed</span><span class="op">=&lt;</span>backup_secret<span class="op">&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Consider:</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - Print and store in a safe</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># - Split into multiple parts (Shamir&#39;s Secret Sharing)</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># - Store in password manager (encrypted)</span></span></code></pre></div>
<h3 id="physical-security">3. Physical Security üîí</h3>
<ul>
<li>Keep YubiKey on your person (keychain, lanyard)</li>
<li>Never leave unattended with computer unlocked</li>
<li>Consider multiple YubiKeys (primary + backup)</li>
</ul>
<h3 id="firmware-updates">4. Firmware Updates</h3>
<ul>
<li>YubiKey firmware <strong>cannot</strong> be updated</li>
<li>Keep track of security advisories from Yubico</li>
<li>Plan hardware refresh cycle (replace every 3-5 years)</li>
</ul>
<hr />
<h2 id="migration-from-sha-1-legacy-vaults">Migration from SHA-1 (Legacy
Vaults)</h2>
<p>If you have existing vaults using SHA-1:</p>
<h3 id="approach-1-create-new-fips-compliant-vault">Approach 1: Create
New FIPS-Compliant Vault</h3>
<ol type="1">
<li>Create new vault with HMAC-SHA256 (follow Step 4)</li>
<li>Export data from old vault</li>
<li>Import into new FIPS-compliant vault</li>
<li>Securely delete old vault</li>
</ol>
<h3 id="approach-2-continue-using-sha-1-not-recommended">Approach 2:
Continue Using SHA-1 (Not Recommended)</h3>
<ul>
<li>‚ö†Ô∏è SHA-1 is cryptographically deprecated (collision attacks)</li>
<li>‚ùå Cannot open in FIPS mode</li>
<li>‚úÖ Still supported for backward compatibility</li>
<li>üîÑ Plan migration to SHA-256</li>
</ul>
<hr />
<h2 id="reference-command-quick-reference">Reference: Command Quick
Reference</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check YubiKey info</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ykman</span> info                          <span class="co"># Comprehensive info</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ykinfo</span> <span class="at">-a</span>                          <span class="co"># All info (alternative)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure FIPS-compliant Challenge-Response</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="ex">ykman</span> otp chalresp <span class="at">--touch</span> <span class="at">--generate</span> 2   <span class="co"># Recommended</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="ex">ykpersonalize</span> <span class="at">-2</span> <span class="at">-ochal-resp</span> <span class="at">-ochal-hmac</span> <span class="at">-ohmac-sha256</span>  <span class="co"># Alternative</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify configuration</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="ex">ykman</span> otp info                     <span class="co"># Check all slots</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="ex">ykinfo</span> <span class="at">-a</span>                          <span class="co"># Detailed info</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Challenge-Response</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;test&quot;</span> <span class="kw">|</span> <span class="ex">ykman</span> otp calculate 2 <span class="at">-H</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset slot (</span><span class="al">WARNING</span><span class="co">: erases configuration)</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="ex">ykman</span> otp delete 2                 <span class="co"># ykman method</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="ex">ykpersonalize</span> <span class="at">-2</span> <span class="at">-z</span>                <span class="co"># ykpersonalize method</span></span></code></pre></div>
<hr />
<h2 id="additional-resources">Additional Resources</h2>
<ul>
<li><strong>Yubico Documentation:</strong> https://docs.yubico.com/</li>
<li><strong>YubiKey Manager:</strong>
https://www.yubico.com/support/download/yubikey-manager/</li>
<li><strong>FIPS-140-3 Standard:</strong>
https://csrc.nist.gov/publications/detail/fips/140/3/final</li>
<li><strong>KeepTower Security:</strong> <a href="SECURITY_BEST_PRACTICES.md">SECURITY_BEST_PRACTICES.md</a></li>
<li><strong>FIPS Compliance Audit:</strong> <a href="../audits/FIPS_YUBIKEY_COMPLIANCE_ISSUE.md">FIPS_YUBIKEY_COMPLIANCE_ISSUE.md</a></li>
</ul>
<hr />
<h2 id="getting-help">Getting Help</h2>
<ul>
<li><strong>Issues:</strong>
https://github.com/your-org/keeptower/issues</li>
<li><strong>Discussions:</strong>
https://github.com/your-org/keeptower/discussions</li>
<li><strong>Security:</strong> security@keeptower.example.com</li>
</ul>
<hr />
<p><strong>Last Updated:</strong> 2026-01-01 <strong>Document
Version:</strong> 1.0 <strong>Maintainer:</strong> KeepTower Security
Team</p>
<div class="footer">
    <p>KeepTower v0.3.1 | <a href="https://github.com/tjdeveng/KeepTower">GitHub</a> | GPL-3.0 License</p>
</div>
</div>
</body>
</html>
